{"componentChunkName":"component---src-templates-post-template-js","path":"/collectors/megaraid/","result":{"data":{"markdownRemark":{"excerpt":"MegaRAID controller monitoring with Netdata Collects adapter, physical drives and battery stats using  command-line tool. Executed commands:   Requirements The…","html":"<h1>MegaRAID controller monitoring with Netdata</h1>\n<p>Collects adapter, physical drives and battery stats using <code class=\"language-text\">megacli</code> command-line tool.</p>\n<p>Executed commands:</p>\n<ul>\n<li><code class=\"language-text\">sudo -n megacli -LDPDInfo -aAll</code></li>\n<li><code class=\"language-text\">sudo -n megacli -AdpBbuCmd -a0</code></li>\n</ul>\n<h2>Requirements</h2>\n<p>The module uses <code class=\"language-text\">megacli</code>, which can only be executed by <code class=\"language-text\">root</code>. It uses\n<code class=\"language-text\">sudo</code> and assumes that it is configured such that the <code class=\"language-text\">netdata</code> user can execute <code class=\"language-text\">megacli</code> as root without a password.</p>\n<ul>\n<li>Add to your <code class=\"language-text\">/etc/sudoers</code> file:</li>\n</ul>\n<p><code class=\"language-text\">which megacli</code> shows the full path to the binary.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">netdata <span class=\"token assign-left variable\">ALL</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">)</span>       NOPASSWD: /path/to/megacli</code></pre></div>\n<ul>\n<li>Reset Netdata’s systemd\nunit <a href=\"https://www.freedesktop.org/software/systemd/man/systemd.exec.html#Capabilities\">CapabilityBoundingSet</a> (Linux\ndistributions with systemd)</li>\n</ul>\n<p>The default CapabilityBoundingSet doesn’t allow using <code class=\"language-text\">sudo</code>, and is quite strict in general. Resetting is not optimal, but a next-best solution given the inability to execute <code class=\"language-text\">megacli</code> using <code class=\"language-text\">sudo</code>.</p>\n<p>As the <code class=\"language-text\">root</code> user, do the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"cmd\"><pre class=\"language-cmd\"><code class=\"language-cmd\">mkdir /etc/systemd/system/netdata.service.d\necho -e &#39;[Service]\\nCapabilityBoundingSet=~&#39; | tee /etc/systemd/system/netdata.service.d/unset-capability-bounding-set.conf\nsystemctl daemon-reload\nsystemctl restart netdata.service</code></pre></div>\n<h2>Charts</h2>\n<ul>\n<li>Adapter State</li>\n<li>Physical Drives Media Errors</li>\n<li>Physical Drives Predictive Failures</li>\n<li>Battery Relative State of Charge</li>\n<li>Battery Cycle Count</li>\n</ul>\n<h2>Enable the collector</h2>\n<p>The <code class=\"language-text\">megacli</code> collector is disabled by default. To enable it, use <code class=\"language-text\">edit-config</code> from the\nNetdata <a href=\"/docs/configure/nodes.md\">config directory</a>, which is typically at <code class=\"language-text\">/etc/netdata</code>, to edit the <code class=\"language-text\">python.d.conf</code>\nfile.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> /etc/netdata   <span class=\"token comment\"># Replace this path with your Netdata config directory, if different</span>\n<span class=\"token function\">sudo</span> ./edit-config python.d.conf</code></pre></div>\n<p>Change the value of the <code class=\"language-text\">megacli</code> setting to <code class=\"language-text\">yes</code>. Save the file and restart the Netdata Agent\nwith <code class=\"language-text\">sudo systemctl restart netdata</code>, or the appropriate method for your system.</p>\n<h2>Configuration</h2>\n<p>Edit the <code class=\"language-text\">python.d/megacli.conf</code> configuration file using <code class=\"language-text\">edit-config</code> from the\nNetdata <a href=\"/docs/configure/nodes.md\">config directory</a>, which is typically at <code class=\"language-text\">/etc/netdata</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> /etc/netdata   <span class=\"token comment\"># Replace this path with your Netdata config directory, if different</span>\n<span class=\"token function\">sudo</span> ./edit-config python.d/megacli.conf</code></pre></div>\n<p>Battery stats disabled by default. To enable them, modify <code class=\"language-text\">megacli.conf</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">do_battery</span><span class=\"token punctuation\">:</span> yes</code></pre></div>\n<p>Save the file and restart the Netdata Agent with <code class=\"language-text\">sudo systemctl restart netdata</code>, or the <a href=\"/docs/configure/start-stop-restart.md\">appropriate\nmethod</a> for your system.</p>","frontmatter":{"title":"MegaRAID controller collector","tags":["collector","python.d"],"date":"January 04, 2021","description":"This is a custom collector for MegaRAID.","social_image":{"absolutePath":"/Users/odys/code/gh-netdata/marketplace/static/media/megaraid.jpg"}}},"prev":null,"next":{"frontmatter":{"title":"Symbol of Apollo"},"fields":{"slug":"/symbol-of-apollo/"}}},"pageContext":{"slug":"/megaraid/","prevSlug":null,"nextSlug":"/symbol-of-apollo/"}},"staticQueryHashes":["2555585279","2841359383","3159585216"]}